[<- Índice](../Pentesting.md)
# Fase 5. Post-explotación

> Reanudando el ataque, la ***post-explotación*** consiste en explorar y aprovechar al máximo lo que sea que conseguimos en la fase de *explotación*.

Es una fase muy abstracta y compleja según sea lo que obtuvimos al explotar la vulnerabilidad, puede comprender desde una simple exfiltración de datos hasta establecer **comando y control** de varios ordenadores, etc.

Principalmente, la ***post-explotación*** se clasifica en:

- **Evasiva**
- **Exfiltrativa**
- **Escalativa** (Movimientos laterales)
- **Comando y control**

## Escalativa

> La ***post-explotación escalativa*** busca elevar nuestra posición en el sistema, respecto a privilegios, permisos y poder en general.

Unos ejemplos muy importantes de este tipo de *post-explotación* son el ***escalamiento de privilegios***, el ***movimiento lateral*** y ***pivoting***.

#### Escalamiento de privilegios

> Al comprometer el acceso a un ordenador, usualmente no accdemos con una cuenta de administrador o con permisos elevados, entonces nuestro nuevo objetivo sería hallar maneras consistentes de ejecutar acciones que requieren más permisos.

Por ejemplo, cambiar a otra cuenta con mayores permisos, comprometer contraseñas o hallar fallas en configuraciones que nos permitan ejecutar una terminal como alguien más.

El objetivo ideal suele ser entrar a la cuenta de superusuario o superadministrador del equipo.

Por ejemplo en *Linux* poseemos algunos vectores de escalamiento de privilegios como:

- Permisos especiales *SUID*: `rwsr-rs-s`.
- Permisos *sudo*: `sudo -l`.
- *Cronjobs*.
- ***Variables de entorno***
- Listar *sudoers*.
- Enumeración de puertos internos `lsof`, `ss` o `netstat`.
- Archivos vulnerables del sistema.
- Archivos de configuración.

***Malas configuraciones***:
- Credenciales
- Actualizaciones
- Permisos
- Puertos

#### Movimiento lateral

> El movimiento lateral consiste en *"expandirse"* o infectar a otros equipos dentro de la red a partir del equipo comprometido inicialmente.

Se hace con el objetivo de recopilar más información útil, escalar privilegios y potencialmente encontrar un ordenador con recursos sensibles o más privilegios que los otros.

#### Pivoting

> Similar al ejemplo anterior, el *Pivoting* consiste en utilizar un sistema comprometido para acceder a recursos que no deberían ser visibles para equipos externos.

Aunque parecido, no debe confundirse con ***movimiento lateral***, este útlimo busca *"explorar"* el resto de computadoras mientras que el ***Pivoting*** consiste en utilizar otro equipo como *"puente"* para redirigir recursos, tráfico o información al ordenador del atacante.

Por ejemplo, el *Pivoting* comprende la redirección de puertos mediante técnicas como *SSH Tunneling* que, en pocas palabras, permite ==encadenar mediante *SSH* todo el tráfico que recibe un puerto de la maquina *pivote* (comprometida) a un puerto de la máquina atacante==.

Esto permite, por poner un ejemplo, redirigir un servicio interno que solo puede comunicarse con la máquina pivote a la nuestra.

## Exfiltrativa

> La ***post-explotación exfiltrativa*** busca extraer la información sensible y relevante de la organización una vez que obtuvimos el acceso a ella.

Por ejemplo, si comprometemos una base de datos con **contraseñas** de un sitio web, nuestro nuevo objetivo sería hallar una manera de extraer todas las contraseñas (o todo) que podamos.

## Evasiva

> La ***post-explotación evasiva*** busca borrar el rastro de cualquier ataque realizado y mantener nuestra presencia oculta en el sistema.

Por ejemplo, despues de realizar un ataque de fuerza bruta  y de ser posible, deseariamos borrar todos los registros y alertas que anuncien nuestros inumerables intentos de acceso y nuestra intrusión final al sistema, para mantener un perfil bajo y conservar nuestro acceso al sistema.

## Comando y control

> Busca establecer comunicación y control ==**persistente**== con el equipo o equipos vulnerados, manteniendo el mando de lso equipos de forma remota para efectuar distintos tipos de acciones maliciosas.

Por ejemplo, implantarles troyanos *RATS* que nos permitan controlar y espiar los equipos comprometidos.

# Enlaces

[<- Anterior](Evaluacion.md) | [Siguiente ->](PruebaConcepto.md)