[<- Índice](../Pentesting.md)
# Descifrado de Esteganografía

> La ***Esteganografía*** es la práctica de ==ocultar información==, mensajes, imágenes o videos dentro de cualquier otra foto, video, archivo totalmente distinto

Existen muchísimas herramientas y/o técnicas que permiten descifrar (o realizar) **esteganografía**.

En esta nota nombraré las que yo he utilizado apoyandome también en la sección *"Stego Tricks"* del blog *"HackTricks"*, pero si me quedo corto siempre puedes revisarlo completo en la página:

> https://book.hacktricks.xyz/crypto-and-stego/stego-tricks

***Consideraciones***:

- Me enfocaré únicamente en el descifrado de información, pues posee más utilidad en este contexto.

- Esta nota esta centrada en imágenes, sin embargo, estas herramientas realizan esteganografía sobre muchos formatos más, de necesitarlo no limiten su uso.

### `Steghide`

> Es una muy ==herramienta básica== para ocultar o extraer la información, principalmente para imágenes `jpg` aunque soporta más formatos como `bmp`, `wav`, etc.

***No funciona con png***

Podemos consultar si un archivo tiene información oculta con:

```bash
steghide info [archivo]
```

Y, de haberla, podemos extraerla con:

```bash
steghide extract -sf [archivo]
```

Podría ser el caso que la información oculta requiera de una contraseña para poder ser descifrada.

En esos casos `steghide` nos pedirá la contraseña, pero si deseamos indicarla desde el comando podemos ejecutar:

```bash
steghide extract -sf [archivo] --passphrase [contraseña]
```

### `Foremost`

> Para los archivos `png` (y otros formatos) podemos utilizar `foremost` una herramienta aun más simple que la anterior.

***¡Es importante que sepamos de antemano que la información oculta no requiere contraseña!***

De lo contrario no extraerá nada.

Para si hay información oculta y extraerla, se realiza con un solo comando:

```bash
foremost -i [archivo]
```

Genera un directorio `output` donde separa en directorios todos los archivos que haya encontrado.

### `Binwalk`

> De manera similar a `foremost`, extrae archivos ocultos (sin contraseña) de algun otro archivo, principalmente `png`.

---
*Nota:*

Cabe mencionar que al utilizarla yo, en su versión más reciente (`cargo`), fallo en encontrar un archivo oculto en un `png`.

Desconozco si falle yo, mi sistema operativo o la herramienta, por eso uso principalmente `foremost`. Aun así, su versión `apt` en los repositorios de *Debian* funcionó perfectamente por lo que aun así está incluida en esta lista.

\- *Ookami*

---

Para revisar los archivos ocultos de otro archivo, se utilza el comando:

```bash
binwalk [archivo]
```

Para extraer los archivos ocultos reconocidos se utiliza;

```bash
binwalk -e [archivo]
```

Para extraer todos los posibles archivos, reconocidos o no, se utiliza:

```bash
binwalk --dd ".*" [archivo]
```

### `Stegcracker`

Todas las herramientas anteriores nos permiten reconocer y extraer la información oculta de manera básica.

> Sin embargo cuando la situación es desesperada, `stegcracker` permite realizar fuerza bruta (*por diccionario*) para hallar la contraseña de un archivo con datos ocultos ***con contraseña***.

Se utiliza de la siguiente manera:

```bash
stegcracker [archivo] [diccionario]
```

Entonces `stegcracker` intentara descifrar los datos ocultos con cada palabra en el diccionario.

# Enlaces

[<- Decodificaciones](Decodificaciones.md) | [Crackeo de Hashes ->](HashCracking.md)