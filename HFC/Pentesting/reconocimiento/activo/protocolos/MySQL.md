[<- Índice](../../../Pentesting.md)
# MySQL

> ***MySQL*** es un sistema de administración de bases de datos **relacionales**, de código abierto y mantenido por *Oracle*.

Una **base de datos** no es más que una colección estructurada y organizada de datos para su óptima consulta y almacenamiento.
Esta colección debe procesar eficientemente grandes volúmenes de datos, reservando la menor cantidad de espacio posible para almacenarlos, segun se necesite.

Las consultas a una base de datos se realizan en **SQL** (*Structured Query Language*), un lenguaje optimizado para especificar la información que necesitamos de la base.

***MySQL*** trabaja en un modelo **servidor-cliente** donde el servidor es el sistema de administración como tal y los clientes aquellos que consultan datos.
Estos datos se encuentran almacenados en **tablas** cada uno con distintas **columnas**, **filas** y **tipos de datos**.
Además, estas bases de datos suelen estar almacenados en archivos de extensión `.sql`.

### Clientes MySQL

Los clientes **MySQL** pueden consultar, modificar, eliminar e insertar información en la base de datos utilizando consultas *SQL*.
Además, las consultas en este lenguaje permiten interactuar con más de una base de datos simultáneamente.

### Bases de datos MySQl

El sistema de administración se aloja en el puerto **3306** del servidor como un servicio más, permitiendo su acceso al internet o a redes internas según se considere.
Por ejemplo *Wordpress* almacena todas las publicaciones, usuarios, contraseñas y demás datos en una base de datos accesible únicamente desde la interfaz *localhost*.

Estos sistemas de bases de datos son ideales para sitios web *dinámicos*, donde se espera eficiencia y rápidez a la hora de mantener y cargar los datos esperados para la página.
Por ejemplo, para un servidor *web* podríamos almacenar datos como:

- Usuarios
- Encabezados
- Clientes
- Correos electrónicos
- Permisos
- Textos
- Claves
- Etc

Datos sensibles como lo son las **contraseñas** puede almacenarse en texto plano en la base, sin embargo, en la práctica suele almacenarse encriptada por su seguridad.
Particularmente, mediante encriptaciones de una sola ida, donde no podemos recuperar el mensaje original, como lo son los *hashes*.

### Comandos MySQL

A través de una interfaz de línea de comandos que se nos habilita una vez que establecemos la conexión con la **base de datos** *MySQL*, podemos ejecutar comandos para interactuar con el complejo sistema de almacenamiento de datos.

Por detrás, estos comandos se convierten a código ejecutable que realiza las acciones solicitadas por el usuario.
Además la base de datos suele informar al usuario de advertencias y errores que hayan surgido durante la ejecución del comando.

Como sabemos, es mediante estos comandos que podemos recuperar, modificar, agregar o eliminar datos dentro del sistema, además de alterar la estructura de las tablas, los detalles de los usuarios, etc.

---

## Configuración

> Actualmente, **MariaDB**, un proyecto bifurcado a partir del código original de **MySQL**, es la opción más utilizada en desarrollos modernos pues heredó todas las características positivas del viejo **MySQL** y sigue bajo el mantenimiento constante del equipo de *Oracle*.

Por eso mismo, nos enfocaremos en las configuraciones típicas presentes en **MariaDB**, que podemos encontrar usualmente en el archivo `/etc/mysql/mysql.conf.d/mysqld.cnf` o `/etc/my.cnf`.

```bash
cat /etc/mysql/mysql.conf.d/mysqld.cnf | grep -v "#" | sed -r '/^\s*$/d'

# [client]
# port		= 3306
# socket		= /var/run/mysqld/mysqld.sock
# 
# [mysqld_safe]
# pid-file	= /var/run/mysqld/mysqld.pid
# socket		= /var/run/mysqld/mysqld.sock
# nice		= 0
# 
# [mysqld]
# skip-host-cache
# skip-name-resolve
# user		= mysql
# pid-file	= /var/run/mysqld/mysqld.pid
# socket		= /var/run/mysqld/mysqld.sock
# port		= 3306
# basedir		= /usr
# datadir		= /var/lib/mysql
# tmpdir		= /tmp
# lc-messages-dir	= /usr/share/mysql
# explicit_defaults_for_timestamp
# 
# symbolic-links=0
# 
# !includedir /etc/mysql/conf.d/
```

### Configuraciones peligrosas

Muchas cosas pueden configurarse erroneamente en un sistema tan complejo, pero entre las opciones mas relevantes se destaca:

| Opción             | Descripción                                                                                                 |
| ------------------ | ----------------------------------------------------------------------------------------------------------- |
| `user`             | Define el usuario bajo el que se ejecuta el servicio *MySQL*.                                               |
| `password`         | Define la contraseña del usuario *MySQL*, utilizable para autenticarse en el servicio.                      |
| `admin_address`    | Define la dirección IP desde la que se escucha para conexiones entrantes especiales, de uso administrativo. |
| `debug`            | Indica el nivel de verbosidad para la depuración de errores del servidor.                                   |
| `sql_warnings`     | Indica si se imprimen o envían advertencias durante cualquier eventualidad en las operaciones.              |
| `secure_file_priv` | Se usa para limitar el efecto de la importación y exportación de datos.                                     |