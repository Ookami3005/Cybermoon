[<- Índice](../../../Pentesting.md)
# Domain Name System

> ***DNS*** (*Domain Name System*) es una de las partes más importantes y vitales del *Internet*. Este permite que utilicemos nombres de dominio para establecer conexiones en lugar de tener que recordar todas las direcciones *IP* de los servidores que nos brindan servicios.

Existe una gran cantidad de servidores *DNS* distribuidos globalmente con el objetivo de realizar las resoluciones de nombres de dominio a sus respectivas direcciones IP.

Además, estos servidores se dividen en varios tipos según su propósito.

| Tipo de Servidor DNS            | Descripción                                                                                                                                                                                                                                       |
| ------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Servidor **raíz**               | Servidores responsables de los ***TLD*** (*Top Level Domain*) como `com`, `mx`, `org`, etc. Son el último recurso, en caso de que un servidor de autoritativo no pueda resolver la solicitud. Actualmente únicamente existen 13 en todo el mundo. |
| Servidores **autoritativos**    | Estos servidores estan encargados de ciertos dominios y se consideran la fuente **oficial** de los registros *DNS* de estos.                                                                                                                      |
| Servidores **no-autoritativos** | Estos serviddores son aquellos que no estan encargados de ningún dominio, y responden solicitudes basandose en su caché de consultas o mediante consultas recursivas.                                                                             |
| Servidores de **caché**         | Estos servidores estan se encargan de mantener como caché la información de otros servidores *DNS*.                                                                                                                                               |
| Servidores de **redirección**   | Este tipo de servidores tiene una única función, redirigir la consulta *DNS* a otro servidor.                                                                                                                                                     |
| Servidores de **resolución**    | Son básicamente **servidores no-autoritativos** pero que realizan resoluciones de nombre de forma locam mediante una computadora o *router*.                                                                                                      |

Sin embargo, el protocolo *DNS* no solo consiste en la resolución de nombres a direcciones *IP*, si no que puede proporcionarnos información adicional referente al dominio, como sus servidores de correo electrónico, sus servidores *DNS* propios y más.

Para esto, la información se divide en una serie de ***Registros*** que almacenan distintos tipos de información, según sea el caso.

| *Registro DNS* | Descripción                                                                                                                                        |
| -------------- | -------------------------------------------------------------------------------------------------------------------------------------------------- |
| `A`            | En estos, se almacenan las direcciones *IPv4* relacionadas al dominio.                                                                             |
| `AAAA`         | Estos almacenan las direcciones *IPv6* relacionadas al dominio.                                                                                    |
| `MX`           | Estos almacenan los servidores de correo electrónico del dominio.                                                                                  |
| `NS`           | Estos almacenan los servidores *DNS* del dominio.                                                                                                  |
| `TXT`          | Estos pueden almacenar información en texto plano muy variada, por ejemplo llaves de validación para servicios, llaves de certificados *SSL*, etc. |
| `CNAME`        | Este registro almacena los alias del dominio solicitado, para cuando más de un dominio apuntas a la misma dirección IP.                            |
| `PTR`          | Este registro funciona como un inverso a los registros `A`, resolviendo direcciones IP a nombres de dominio.                                       |
| `SOA`          | Estos registros almacenan información correspondiente a la zona *DNS* y datos de contacto administrativo.                                          |

## Configuración

> Existen varios tipos de configuraciones para un servidor *DNS*, dada la versatilidad del protocolo, sin embargo las 3 más importantes son:

1. Configuración **local** del servidor *DNS*
2. Configuración de **zonas**
3. Configuración de **resoluciones inversas**

Para la configuración, tomaremos de ejemplo el servidor ***Bind 9***, comúnmente utilizado en distribuciones *Linux*, cuyos archivos de configuraciones **locales** son:

- `named.conf.local`
- `named.conf.options`
- `named.conf.log`

Dentro de estos archivos, podemos definir tanto configuraciones **globales**, para todas las zonas, como configuraciones específicas **por zona**.