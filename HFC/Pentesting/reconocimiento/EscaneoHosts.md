[<- Índice](../Pentesting.md)
# Detección de Hosts

> Ahora que introduje lo más adecuadamente que pude *Nmap*, quiero hablarles sobre las distintas técnicas de ***Descubrimiento de Hosts*** en una red que nos brinda *Nmap*.

Por supuesto antes de seleccionar un objetivo y escanear sus puertos, muchas veces tenemos que descubrir que hosts están **activos** en la red y cual de ellos nos interesa más.

### Barrido ping

> La manera más típica de detectar *hosts* en una red se conoce como un ***barrido ping*** donde lanzamos una solicitud ICMP *ping* a cada posible *host* y esperamos que nos responda para concluir que está activo o de lo contrario concluiremos que está cerrado.

***¿Y como realizamos esto con Nmap?*** Pues sabemos que por regla general, *Nmap* realiza una solicitud ICMP *ping* al objetivo antes de escanear sus puertos, entonces solo hay que indicarle el rango de *hosts* por escanear y que únicamente realice el ping y no continue con el resto de la operación.

Esto se logra con la bandera `-sn`, que incluso actualmente ya se considera y se comporta como un ***modo de escaneo Ping*** por su alta utilidad para el descubrimiento de *hosts*.

```bash
nmap -sn 192.168.90.0/24

# Starting Nmap 7.95 ( https://nmap.org ) at 2024-11-24 12:39 CST
# Nmap scan report for 192.168.90.1
# Host is up (0.050s latency).
# Nmap scan report for 192.168.90.17
# Host is up (0.00025s latency).
# Nmap scan report for 192.168.90.46
# Host is up (0.047s latency).
# Nmap scan report for 192.168.90.66
# Host is up (0.026s latency).
# Nmap scan report for 192.168.90.75
# Host is up (0.38s latency).
# Nmap scan report for 192.168.90.78
# Host is up (0.14s latency).
# Nmap scan report for 192.168.90.80
# Host is up (0.13s latency).
# Nmap scan report for 192.168.90.117
# Host is up (0.12s latency).
# Nmap done: 256 IP addresses (8 hosts up) scanned in 23.94 seconds
```

#### ARP

Al escanear la red en la que te encuentras, *Nmap* utiliza por defecto solicitudes ARP *ping* en lugar de solicitudes ICMP.

Si por cualquier razón quisieras utilizar *ICMP* en lugar de *ARP* para redes locales, puedes indicarlo con la bandera `--disable-arp-ping`.

### Listado

> *Nmap* posee la opción `-sL` cuya única función es listar las direcciones específicadas para verificar su validez. Sin embargo, realiza algo muy útil para la enumeración de *hosts*, una ***resolución de nombre de dominio***.

Es decir, intenta resolver cada una de las direcciones *IP* proporcionadas a su nombre de dominio, lo cual en caso de resolverse correctamente, ==puede indicarnos que dicho *host* está activo== pues posee un nombre de dominio asignado.

Este tipo de reconocimiento rara vez necesita de interactuar directamente con el objetivo, entonces es una forma sigilosa de recabar esta información al carecer de envío de paquetes.

Aun así, este mismo punto fuerte es su punto debil porque también ==carece de la certeza== que puede brindarte una respuesta directa del objetivo, nunca se sabe cuando el *host* podría estar abajo aunque posea un nombre de dominio.

Por esto mismo aunque útil, no recomiendo fiarse al 100% de esta forma de reconocimiento de *hosts*.

### Escaneo de Hosts TCP-SYN

> Como mencione anteriormente, la manera más típica de verificar la actividad de un *host* es recibiendo una respuesta a una solicitud ICMP *ping*. Por eso mismo, por parte del *host*, cuando se pretende pasar desapercibido por un escaneo de *hosts* se suele deshabilitar estas respuestas a solicitudes ICMP *ping*.

***¿Es este el final para nosotros como atacantes?*** Por supuesto que no, nuestro espiritu reside en burlar este tipo de medidas. El *host* podra ocultar su actividad ante las solicitudes ICMP, pero no se pueden ocultar las ==respuestas de los puertos== (realmente si con la ayuda de un *Firewall* pero ya nos preocuparemos en otro momento).

Entonces la nueva idea, es enviar un paquete con la bandera *SYN* a uno o varios puertos del objetivo. De recibir una respuesta, ya sea afirmativa o negativa podemos confirmar la actividad del objetivo.

```bash
nmap -sn -PS22,53,80,443 192.168.90.0/24
```

# Enlaces

[<- Nmap básico](Nmap.md) |